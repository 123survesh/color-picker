/*!
 * ==========================================================
 *  COLOR PICKER PLUGIN 1.0.0
 * ==========================================================
 * Author: Taufik Nurrohman <http://latitudu.com>
 * Licensed under the MIT license.
 * ----------------------------------------------------------
 */

var CP=function(t){function e(t){return void 0!==t}function n(t){var e,n,r,o,s,c,u,i,a=+t[0],f=+t[1],l=+t[2];switch(o=Math.floor(6*a),s=6*a-o,c=l*(1-f),u=l*(1-s*f),i=l*(1-(1-s)*f),isNaN(o)&&(o=0),isNaN(u)&&(u=0),isNaN(i)&&(i=0),o%6){case 0:e=l,n=i,r=c;break;case 1:e=u,n=l,r=c;break;case 2:e=c,n=l,r=i;break;case 3:e=c,n=u,r=l;break;case 4:e=i,n=c,r=l;break;case 5:e=l,n=c,r=u}return[Math.round(255*e),Math.round(255*n),Math.round(255*r)]}function r(t){return s(n(t))}function o(t){var e,n=+t[0],r=+t[1],o=+t[2],s=Math.max(n,r,o),c=Math.min(n,r,o),u=s-c,i=0===s?0:u/s,a=s/255;switch(s){case c:e=0;break;case n:e=r-o+u*(o>r?6:0),e/=6*u;break;case r:e=o-n+2*u,e/=6*u;break;case o:e=n-r+4*u,e/=6*u}return[e,i,a]}function s(t){var e=+t[2]|+t[1]<<8|+t[0]<<16;return e="000000"+e.toString(16),e.slice(-6)}function c(t){return o(u(t))}function u(t){return 3===t.length&&(t=t.replace(/./g,"$&$&")),[parseInt(t[0]+t[1],16),parseInt(t[2]+t[3],16),parseInt(t[4]+t[5],16)]}function i(t){return[+t[0]/360,+t[1]/100,+t[2]/100]}function a(t){return[Math.round(360*+t[0]),Math.round(100*+t[1]),Math.round(100*+t[2])]}function f(t,e,n){return e.addEventListener(t,n,!1)}function l(t,e,n){return e.removeEventListener(t,n)}function p(t,e){for(var n=e.touches?e.touches[0].pageX:e.pageX,r=e.touches?e.touches[0].pageY:e.pageY,o=t.offsetLeft,s=t.offsetTop;t=t.offsetParent;)o+=t.offsetLeft,s+=t.offsetTop,t=t.offsetParent;return{x:n-o,y:r-s}}function h(t){return{l:t.offsetLeft,t:t.offsetTop}}function d(t){return{w:t.offsetWidth,h:t.offsetHeight}}function v(t){return E||(e(t)?t:!1)}function g(t){E=t}function m(t,n,r){return e(S[t])||(S[t]={}),e(t)?e(n)?e(r)?(S[t][r]=n,M):(S[t][Object.keys(S[t]).length]=n,M):(S[t],M):M}function y(t,n){return e(t)?e(n)?(delete S[t][n],M):(S[t]={},M):(S={},M)}function k(t,n,r){if(!e(S[t]))return M;if(e(r))e(S[t][r])&&S[t][r].apply(M,n);else for(var o in S[t])S[t][o].apply(M,n);return M}function x(){var e=d(C).w,n=b.innerHeight,r=Math.max(X.scrollLeft,C.scrollLeft),o=Math.max(X.scrollTop,C.scrollTop),s=e+r,c=n+o;return I=h(t).l,D=h(t).t+d(t).h,I+Y>s&&(I=s-Y),D+z>c&&(D=c-z),L.style.left=I+"px",L.style.top=D+"px",k("fit",[M]),M}function H(e){function o(t){H(),k("click",[M]),t.stopPropagation(),t.preventDefault()}function s(t){var e=(n(B),n([B[0],1,1]));R.style.backgroundColor="rgb("+e.join(",")+")",g(B),t&&t.preventDefault()}function c(t){var e=p(G,t),n=e.y;0>n?n=0:n>E&&(n=E),B[0]=1-(E-n)/E,$.style.top=n-T/2+"px",s(t)}function u(t){var e=p(R,t),n=e.x,r=e.y;0>n?n=0:n>S&&(n=S),0>r?r=0:r>C&&(r=C),B[1]=1-(S-n)/S,B[2]=(C-r)/C,P.style.right=S-n-I/2+"px",P.style.top=r-D/2+"px",s(t)}function i(t){_&&(c(t),y=r(B),k("drag:h",[y,M]),k("drag",[y,M])),j&&(u(t),y=r(B),k("drag:sv",[y,M]),k("drag",[y,M]))}function a(){e||(y=r(B),k("stop:"+(_?"h":"sv"),[y,M]),k("stop",[y,M])),_=!1,j=!1}function h(t){_=!0,c(t),k("start:h",[M]),k("start",[M])}function m(t){j=!0,u(t),k("start:sv",[M]),k("start",[M])}e||X.appendChild(L),Y=d(L).w,z=d(L).h;var y,E=d(G).h,S=d(R).w,C=d(R).h,T=d($).h,I=d(P).w,D=d(P).h;e?(L.style.left="-9999px",L.style.top="-9999px",f("resize",b,x),f("click",t,o),M.create=function(){return H(1),k("create",[M]),M},M.destroy=function(){return l("click",t,o),g(!1),V(),k("destroy",[M]),M}):(x(),k("enter",[M])),N=function(){B=v(t,B),s(),$.style.top=E*+B[0]-T/2+"px",P.style.right=S-I/2-S*+B[1]+"px",P.style.top=C-D/2-C*+B[2]+"px"},V=function(){return L.parentNode&&X.removeChild(L),l("touchmove",w,i),l("mousemove",w,i),l("touchend",w,a),l("mouseup",w,a),l("touchdown",w,V),l("click",w,V),k("exit",[M]),M},N(),f("touchstart",G,h),f("mousedown",G,h),f("touchstart",R,m),f("mousedown",R,m),f("touchmove",w,i),f("mousemove",w,i),f("touchend",w,a),f("mouseup",w,a),f("touchdown",w,V),f("click",w,V)}var b=window,w=document,M=this,E=!1,S={},L=w.createElement("div");M.parse=function(t){if("object"==typeof t)return t;var e=/\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i.exec(t),n=/\s*hsv\s*\(\s*(\d+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*\)\s*$/i.exec(t),r="#"===t[0]&&t.match(/^#([\da-f]{3}|[\da-f]{6})$/);return r?c(t.slice(1)):n?i([+n[1],+n[2],+n[3]]):e?o([+e[1],+e[2],+e[3]]):[0,1,1]},g(M.parse(t.getAttribute("data-color")||t.value||[0,1,1])),L.className="color-picker",L.innerHTML='<div class="color-picker-control"><span class="color-picker-h"><i></i></span><span class="color-picker-sv"><i></i></span></div>';var N,V,X=w.body,C=w.documentElement,T=L.firstChild.children,B=v(t,[0,1,1]),G=T[0],R=T[1],$=G.firstChild,P=R.firstChild,_=!1,j=!1,I=0,D=0,Y=0,z=0;return H(1),b.setTimeout(function(){k("create",[r(B),M])},.1),M.target=t,M.picker=L,M.on=m,M.off=y,M.trigger=k,M.fit=x,M.set=function(t){return"string"==typeof t&&(t=M.parse(t)),e(t)?(g(t),N(),M):v()},M.HSV2RGB=function(t){return n(i(t))},M._HSV2RGB=n,M.HSV2HEX=function(t){return r(i(t))},M._HSV2HEX=r,M.RGB2HSV=function(t){return a(o(t))},M._RGB2HSV=o,M.RGB2HEX=s,M.HEX2HSV=function(t){return a(c(t))},M._HEX2HSV=c,M.HEX2RGB=u,M.hooks=S,M.enter=H,M.exit=V,M};