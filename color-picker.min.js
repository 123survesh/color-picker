/*!
 * ==========================================================
 *  COLOR PICKER PLUGIN 1.0.0
 * ==========================================================
 * Author: Taufik Nurrohman <http://latitudu.com>
 * Licensed under the MIT license.
 * ----------------------------------------------------------
 */

var CP=function(t){function e(t){return void 0!==t}function r(t){var e,r,n,o,s,a,c,u,i=+t[0],f=+t[1],l=+t[2];switch(o=Math.floor(6*i),s=6*i-o,a=l*(1-f),c=l*(1-s*f),u=l*(1-(1-s)*f),isNaN(o)&&(o=0),isNaN(c)&&(c=0),isNaN(u)&&(u=0),o%6){case 0:e=l,r=u,n=a;break;case 1:e=c,r=l,n=a;break;case 2:e=a,r=l,n=u;break;case 3:e=a,r=c,n=l;break;case 4:e=u,r=a,n=l;break;case 5:e=l,r=a,n=c}return[Math.round(255*e),Math.round(255*r),Math.round(255*n)]}function n(t){return s(r(t))}function o(t){var e,r=+t[0],n=+t[1],o=+t[2],s=Math.max(r,n,o),a=Math.min(r,n,o),c=s-a,u=0===s?0:c/s,i=s/255;switch(s){case a:e=0;break;case r:e=n-o+c*(o>n?6:0),e/=6*c;break;case n:e=o-r+2*c,e/=6*c;break;case o:e=r-n+4*c,e/=6*c}return[e,u,i]}function s(t){var e=+t[2]|+t[1]<<8|+t[0]<<16;return e="000000"+e.toString(16),e.slice(-6)}function a(t){return o(c(t))}function c(t){return 3===t.length&&(t=t.replace(/./g,"$&$&")),[parseInt(t[0]+t[1],16),parseInt(t[2]+t[3],16),parseInt(t[4]+t[5],16)]}function u(t){return[+t[0]/360,+t[1]/100,+t[2]/100]}function i(t){return[Math.round(360*+t[0]),Math.round(100*+t[1]),Math.round(100*+t[2])]}function f(t,e,r){return e.addEventListener(t,r,!1)}function l(t,e,r){return e.removeEventListener(t,r)}function p(t,e){for(var r=e.touches?e.touches[0].pageX:e.pageX,n=e.touches?e.touches[0].pageY:e.pageY,o=t.offsetLeft,s=t.offsetTop;t=t.offsetParent;)o+=t.offsetLeft,s+=t.offsetTop,t=t.offsetParent;return{x:r-o,y:n-s}}function h(t){return{l:t.offsetLeft,t:t.offsetTop}}function d(t){return{w:t.offsetWidth,h:t.offsetHeight}}function v(t,r){var n=t.getAttribute("data-color");return n=n?n.split(","):[],e(r)||(r=!1),3===n.length?[+n[0],+n[1],+n[2]]:r}function g(t,e){return e===!1?t.removeAttribute("data-color"):t.setAttribute("data-color",e.join(","))}function m(t,r,n){return e(E[t])||(E[t]={}),e(t)?e(r)?e(n)?(E[t][n]=r,M):(E[t][Object.keys(E[t]).length]=r,M):(E[t],M):M}function y(t,r){return e(t)?e(r)?(delete E[t][r],M):(E[t]={},M):(E={},M)}function k(t,r,n){if(!e(E[t]))return M;if(e(n))e(E[t][n])&&E[t][n].apply(M,r);else for(var o in E[t])E[t][o].apply(M,r);return M}function x(){var e=d(C).w,r=H.innerHeight,n=Math.max(X.scrollLeft,C.scrollLeft),o=Math.max(X.scrollTop,C.scrollTop),s=e+n,a=r+o;return _=h(t).l,I=h(t).t+d(t).h,_+D>s&&(_=s-D),I+Y>a&&(I=a-Y),S.style.left=_+"px",S.style.top=I+"px",k("fit",[M]),M}function b(e){function o(t){b(),k("click",[M]),t.stopPropagation(),t.preventDefault()}function s(e){var n=(r(B),r([B[0],1,1]));R.style.backgroundColor="rgb("+n.join(",")+")",g(t,B),e&&e.preventDefault()}function a(t){var e=p(G,t),r=e.y;0>r?r=0:r>E&&(r=E),B[0]=1-(E-r)/E,$.style.top=r-T/2+"px",s(t)}function c(t){var e=p(R,t),r=e.x,n=e.y;0>r?r=0:r>L&&(r=L),0>n?n=0:n>C&&(n=C),B[1]=1-(L-r)/L,B[2]=(C-n)/C,j.style.right=L-r-_/2+"px",j.style.top=n-I/2+"px",s(t)}function u(t){A&&(a(t),y=n(B),k("drag:h",[y,M]),k("drag",[y,M])),P&&(c(t),y=n(B),k("drag:sv",[y,M]),k("drag",[y,M]))}function i(){e||(y=n(B),k("stop:"+(A?"h":"sv"),[y,M]),k("stop",[y,M])),A=!1,P=!1}function h(t){A=!0,a(t),k("start:h",[M]),k("start",[M])}function m(t){P=!0,c(t),k("start:sv",[M]),k("start",[M])}e||X.appendChild(S),D=d(S).w,Y=d(S).h;var y,E=d(G).h,L=d(R).w,C=d(R).h,T=d($).h,_=d(j).w,I=d(j).h;e?(S.style.left="-9999px",S.style.top="-9999px",f("resize",H,x),f("click",t,o),M.create=function(){return b(1),k("create",[M]),M},M.destroy=function(){return l("click",t,o),g(t,!1),V(),k("destroy",[M]),M}):(x(),k("enter",[M])),N=function(){B=v(t,B),s(),$.style.top=E*+B[0]-T/2+"px",j.style.right=L-_/2-L*+B[1]+"px",j.style.top=C-I/2-C*+B[2]+"px"},V=function(){return S.parentNode&&X.removeChild(S),l("touchmove",w,u),l("mousemove",w,u),l("touchend",w,i),l("mouseup",w,i),l("touchdown",w,V),l("click",w,V),k("exit",[M]),M},N(),f("touchstart",G,h),f("mousedown",G,h),f("touchstart",R,m),f("mousedown",R,m),f("touchmove",w,u),f("mousemove",w,u),f("touchend",w,i),f("mouseup",w,i),f("touchdown",w,V),f("click",w,V)}var H=window,w=document,M=this,E={},S=w.createElement("div");if(M.parse=function(t){if("object"==typeof t)return t;var e=/\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i.exec(t),r=/\s*hsv\s*\(\s*(\d+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*\)\s*$/i.exec(t),n="#"===t[0]&&t.match(/^#([\da-f]{3}|[\da-f]{6})$/);return n?a(t.slice(1)):r?u([+r[1],+r[2],+r[3]]):e?o([+e[1],+e[2],+e[3]]):[0,1,1]},t.value&&t.value.length)g(t,M.parse(t.value));else if(!t.value){var L=v(t,t.getAttribute("data-color"));L&&g(t,M.parse(L))}S.className="color-picker",S.innerHTML='<div class="color-picker-control"><span class="color-picker-h"><i></i></span><span class="color-picker-sv"><i></i></span></div>';var N,V,X=w.body,C=w.documentElement,T=S.firstChild.children,B=v(t,[0,1,1]),G=T[0],R=T[1],$=G.firstChild,j=R.firstChild,A=!1,P=!1,_=0,I=0,D=0,Y=0;return b(1),H.setTimeout(function(){k("create",[n(B),M])},.1),M.target=t,M.picker=S,M.on=m,M.off=y,M.trigger=k,M.fit=x,M.set=function(r){return"string"==typeof r&&(r=M.parse(r)),e(r)?(g(t,r),N(),M):v(t)},M.HSV2RGB=function(t){return r(u(t))},M._HSV2RGB=r,M.HSV2HEX=function(t){return n(u(t))},M._HSV2HEX=n,M.RGB2HSV=function(t){return i(o(t))},M._RGB2HSV=o,M.RGB2HEX=s,M.HEX2HSV=function(t){return i(a(t))},M._HEX2HSV=a,M.HEX2RGB=c,M.hooks=E,M.enter=b,M.exit=V,M};