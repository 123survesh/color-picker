/*!
 * ==========================================================
 *  COLOR PICKER PLUGIN 1.0.0
 * ==========================================================
 * Author: Taufik Nurrohman <http://latitudu.com>
 * Licensed under the MIT license.
 * ----------------------------------------------------------
 */

var CP=function(t){function e(t){return void 0!==t}function n(t){var e,n,r,o,i,s,c,u,a=+t[0],f=+t[1],l=+t[2];switch(o=Math.floor(6*a),i=6*a-o,s=l*(1-f),c=l*(1-i*f),u=l*(1-(1-i)*f),isNaN(o)&&(o=0),isNaN(c)&&(c=0),isNaN(u)&&(u=0),o%6){case 0:e=l,n=u,r=s;break;case 1:e=c,n=l,r=s;break;case 2:e=s,n=l,r=u;break;case 3:e=s,n=c,r=l;break;case 4:e=u,n=s,r=l;break;case 5:e=l,n=s,r=c}return[Math.round(255*e),Math.round(255*n),Math.round(255*r)]}function r(t){return i(n(t))}function o(t){var e,n=+t[0],r=+t[1],o=+t[2],i=Math.max(n,r,o),s=Math.min(n,r,o),c=i-s,u=0===i?0:c/i,a=i/255;switch(i){case s:e=0;break;case n:e=r-o+c*(o>r?6:0),e/=6*c;break;case r:e=o-n+2*c,e/=6*c;break;case o:e=n-r+4*c,e/=6*c}return[e,u,a]}function i(t){var e=+t[2]|+t[1]<<8|+t[0]<<16;return e="000000"+e.toString(16),e.slice(-6)}function s(t){return o(c(t))}function c(t){return 3===t.length&&(t=t.replace(/./g,"$&$&")),[parseInt(t[0]+t[1],16),parseInt(t[2]+t[3],16),parseInt(t[4]+t[5],16)]}function u(t){return[1*(+t[0]/360),1-+t[1]/100,1-+t[2]/100]}function a(t){return[Math.round(360*+t[0]),Math.round(100*+t[1]),Math.round(100*+t[2])]}function f(t){var e=/\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i.exec(t),n=/\s*hsv\s*\(\s*(\d+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*\)\s*$/i.exec(t),r="#"===t[0]&&t.match(/^#([\da-f]{3}|[\da-f]{6})$/);return r?s(t.slice(1)):n?u([+n[1],+n[2],+n[3]]):e?o([+e[1],+e[2],+e[3]]):[0,1,1]}function l(t,e,n){return e.addEventListener(t,n,!1)}function d(t,e,n){return e.removeEventListener(t,n)}function h(t,e){for(var n=e.touches?e.touches[0].pageX:e.pageX,r=e.touches?e.touches[0].pageY:e.pageY,o=t.offsetLeft,i=t.offsetTop;t=t.offsetParent;)o+=t.offsetLeft,i+=t.offsetTop,t=t.offsetParent;return{x:n-o,y:r-i}}function p(t){return{l:t.offsetLeft,t:t.offsetTop}}function v(t){return{w:t.offsetWidth,h:t.offsetHeight}}function g(t,n){var r=t.getAttribute("data-color");return r=r?r.split(","):[],e(n)||(n=!1),3===r.length?[+r[0],+r[1],+r[2]]:n}function k(t,e){return e===!1?t.removeAttribute("data-color"):t.setAttribute("data-color",e.join(","))}function m(t,n,r){return e(E[t])||(E[t]={}),e(t)?e(n)?e(r)?void(E[t][r]=n):E[t][Object.keys(E[t]).length]=n:E[t]:E}function y(t,n){return e(t)?e(n)?void delete E[t][n]:E[t]={}:E={}}function H(t,n,r){if(e(E[t]))if(e(r))e(E[t][r])&&E[t][r](n);else for(var o in E[t])E[t][o](n)}function b(){P=p(t).l,j=p(t).t+v(t).h,P+I>w.innerWidth&&(P=w.innerWidth-I),j+W>w.innerHeight&&(j=w.innerHeight-W),V.style.left=P+"px",V.style.top=j+"px",H("fit",S)}function x(e){function o(t){x(),H("click",S),t.stopPropagation()}function i(e){var r=(n(G),n([G[0],1,1]));R.style.backgroundColor="rgb("+r.join(",")+")",k(t,G),e&&e.preventDefault()}function s(t){var e=h(L,t),n=e.y;0>n?n=0:n>y&&(n=y),G[0]=1-(y-n)/y,T.style.top=n-B/2+"px",i(t)}function c(t){var e=h(R,t),n=e.x,r=e.y;0>n?n=0:n>E&&(n=E),0>r?r=0:r>N&&(r=N),G[1]=1-(E-n)/E,G[2]=(N-r)/N,$.style.right=E-n-P/2+"px",$.style.top=r-j/2+"px",i(t)}function u(t){_&&(s(t),m=r(G),H("drag:h",m),H("drag",m)),A&&(c(t),m=r(G),H("drag:sv",m),H("drag",m))}function a(){_=!1,A=!1,e||H("stop",r(G))}function f(t){_=!0,s(t),H("start:h",S),H("start",S)}function p(t){A=!0,c(t),H("start:sv",S),H("start",S)}e||M.body.appendChild(V),I=v(V).w,W=v(V).h;var m,y=v(L).h,E=v(R).w,N=v(R).h,B=v(T).h,P=v($).w,j=v($).h;e?(V.style.left="-9999px",V.style.top="-9999px",l("resize",w,b),l("click",t,o),S.create=function(){x(1),H("create",S)},S.destroy=function(){d("click",t,o),k(t,!1),C(),H("destroy",S)}):(b(),H("enter",S)),X=function(){G=g(t,G),i(),T.style.top=y*+G[0]-B/2+"px",$.style.right=E-P/2-E*+G[1]+"px",$.style.top=N-j/2-N*+G[2]+"px"},C=function(){V.parentNode&&M.body.removeChild(V),d("touchmove",M,u),d("mousemove",M,u),d("touchend",M,a),d("mouseup",M,a),d("touchdown",M,C),d("click",M,C),H("exit",S)},X(),l("touchstart",L,f),l("mousedown",L,f),l("touchstart",R,p),l("mousedown",R,p),l("touchmove",M,u),l("mousemove",M,u),l("touchend",M,a),l("mouseup",M,a),l("touchdown",M,C),l("click",M,C)}var w=window,M=document,S=this,E={},V=M.createElement("div");if(t.value&&t.value.length)k(t,f(t.value));else if(!t.value){var N=g(t,t.getAttribute("data-color"));N&&k(t,f(N))}V.className="color-picker",V.innerHTML='<div class="color-picker-control"><span class="color-picker-h"><i></i></span><span class="color-picker-sv"><i></i></span></div>';var X,C,B=V.firstChild.children,G=g(t,[0,1,1]),L=B[0],R=B[1],T=L.firstChild,$=R.firstChild,_=!1,A=!1,P=0,j=0,I=0,W=0;return x(1),w.setTimeout(function(){H("create",r(G))},.1),S.target=t,S.picker=V,S.on=m,S.off=y,S.trigger=H,S.fit=b,S.set=function(n){return"string"==typeof n&&(n=f(n)),e(n)?(k(t,n),void X()):g(t)},S.HSV2RGB=function(t){return n(u(t))},S._HSV2RGB=n,S.HSV2HEX=function(t){return r(u(t))},S._HSV2HEX=r,S.RGB2HSV=function(t){return a(o(t))},S._RGB2HSV=o,S.RGB2HEX=i,S.HEX2HSV=function(t){return a(s(t))},S._HEX2HSV=s,S.HEX2RGB=c,S._2HSV=f,S.hooks=E,S.enter=x,S.exit=C,S};