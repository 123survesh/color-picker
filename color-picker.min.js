/*!
 * ==========================================================
 *  COLOR PICKER PLUGIN 1.0.0
 * ==========================================================
 * Author: Taufik Nurrohman <http://latitudu.com>
 * Licensed under the MIT license.
 * ----------------------------------------------------------
 */

var CP=function(t){function e(t){return void 0!==t}function r(t){var e,r,n,o,s,a,i,u,c=+t[0],f=+t[1],l=+t[2];switch(o=Math.floor(6*c),s=6*c-o,a=l*(1-f),i=l*(1-s*f),u=l*(1-(1-s)*f),isNaN(o)&&(o=0),isNaN(i)&&(i=0),isNaN(u)&&(u=0),o%6){case 0:e=l,r=u,n=a;break;case 1:e=i,r=l,n=a;break;case 2:e=a,r=l,n=u;break;case 3:e=a,r=i,n=l;break;case 4:e=u,r=a,n=l;break;case 5:e=l,r=a,n=i}return[Math.round(255*e),Math.round(255*r),Math.round(255*n)]}function n(t){return s(r(t))}function o(t){var e,r=+t[0],n=+t[1],o=+t[2],s=Math.max(r,n,o),a=Math.min(r,n,o),i=s-a,u=0===s?0:i/s,c=s/255;switch(s){case a:e=0;break;case r:e=n-o+i*(o>n?6:0),e/=6*i;break;case n:e=o-r+2*i,e/=6*i;break;case o:e=r-n+4*i,e/=6*i}return[e,u,c]}function s(t){var e=+t[2]|+t[1]<<8|+t[0]<<16;return e="000000"+e.toString(16),e.slice(-6)}function a(t){return o(i(t))}function i(t){return 3===t.length&&(t=t.replace(/./g,"$&$&")),[parseInt(t[0]+t[1],16),parseInt(t[2]+t[3],16),parseInt(t[4]+t[5],16)]}function u(t){return[+t[0]/360,+t[1]/100,+t[2]/100]}function c(t){return[Math.round(360*+t[0]),Math.round(100*+t[1]),Math.round(100*+t[2])]}function f(t,e,r){return e.addEventListener(t,r,!1)}function l(t,e,r){return e.removeEventListener(t,r)}function p(t,e){for(var r=e.touches?e.touches[0].pageX:e.pageX,n=e.touches?e.touches[0].pageY:e.pageY,o=t.offsetLeft,s=t.offsetTop;t=t.offsetParent;)o+=t.offsetLeft,s+=t.offsetTop,t=t.offsetParent;return{x:r-o,y:n-s}}function h(t){return{l:t.offsetLeft,t:t.offsetTop}}function d(t){return{w:t.offsetWidth,h:t.offsetHeight}}function v(t,r){var n=t.getAttribute("data-color");return n=n?n.split(","):[],e(r)||(r=!1),3===n.length?[+n[0],+n[1],+n[2]]:r}function g(t,e){return e===!1?t.removeAttribute("data-color"):t.setAttribute("data-color",e.join(","))}function m(t,r,n){return e(E[t])||(E[t]={}),e(t)?e(r)?e(n)?(E[t][n]=r,M):(E[t][Object.keys(E[t]).length]=r,M):(E[t],M):M}function y(t,r){return e(t)?e(r)?(delete E[t][r],M):(E[t]={},M):(E={},M)}function k(t,r,n){if(!e(E[t]))return M;if(e(n))e(E[t][n])&&E[t][n].apply(M,r);else for(var o in E[t])E[t][o].apply(M,r);return M}function x(){var e=d(L).w,r=H.innerHeight,n=Math.max(C.scrollLeft,L.scrollLeft),o=Math.max(C.scrollTop,L.scrollTop),s=e+n,a=r+o;return _=h(t).l,I=h(t).t+d(t).h,_+D>s&&(_=s-D),I+Y>a&&(I=a-Y),S.style.left=_+"px",S.style.top=I+"px",k("fit",[M]),M}function b(e){function o(t){b(),k("click",[M]),t.stopPropagation(),t.preventDefault()}function s(e){var n=(r(G),r([G[0],1,1]));T.style.backgroundColor="rgb("+n.join(",")+")",g(t,G),e&&e.preventDefault()}function a(t){var e=p(R,t),r=e.y;0>r?r=0:r>E&&(r=E),G[0]=1-(E-r)/E,$.style.top=r-B/2+"px",s(t)}function i(t){var e=p(T,t),r=e.x,n=e.y;0>r?r=0:r>N&&(r=N),0>n?n=0:n>L&&(n=L),G[1]=1-(N-r)/N,G[2]=(L-n)/L,j.style.right=N-r-_/2+"px",j.style.top=n-I/2+"px",s(t)}function u(t){A&&(a(t),y=n(G),k("drag:h",[y,M]),k("drag",[y,M])),P&&(i(t),y=n(G),k("drag:sv",[y,M]),k("drag",[y,M]))}function c(){A=!1,P=!1,e||k("stop",[n(G),M])}function h(t){A=!0,a(t),k("start:h",[M]),k("start",[M])}function m(t){P=!0,i(t),k("start:sv",[M]),k("start",[M])}e||C.appendChild(S),D=d(S).w,Y=d(S).h;var y,E=d(R).h,N=d(T).w,L=d(T).h,B=d($).h,_=d(j).w,I=d(j).h;e?(S.style.left="-9999px",S.style.top="-9999px",f("resize",H,x),f("click",t,o),M.create=function(){return b(1),k("create",[M]),M},M.destroy=function(){return l("click",t,o),g(t,!1),X(),k("destroy",[M]),M}):(x(),k("enter",[M])),V=function(){G=v(t,G),s(),$.style.top=E*+G[0]-B/2+"px",j.style.right=N-_/2-N*+G[1]+"px",j.style.top=L-I/2-L*+G[2]+"px"},X=function(){return S.parentNode&&C.removeChild(S),l("touchmove",w,u),l("mousemove",w,u),l("touchend",w,c),l("mouseup",w,c),l("touchdown",w,X),l("click",w,X),k("exit",[M]),M},V(),f("touchstart",R,h),f("mousedown",R,h),f("touchstart",T,m),f("mousedown",T,m),f("touchmove",w,u),f("mousemove",w,u),f("touchend",w,c),f("mouseup",w,c),f("touchdown",w,X),f("click",w,X)}var H=window,w=document,M=this,E={},S=w.createElement("div");if(M.parse=function(t){if("object"==typeof t)return t;var e=/\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i.exec(t),r=/\s*hsv\s*\(\s*(\d+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*\)\s*$/i.exec(t),n="#"===t[0]&&t.match(/^#([\da-f]{3}|[\da-f]{6})$/);return n?a(t.slice(1)):r?u([+r[1],+r[2],+r[3]]):e?o([+e[1],+e[2],+e[3]]):[0,1,1]},t.value&&t.value.length)g(t,M.parse(t.value));else if(!t.value){var N=v(t,t.getAttribute("data-color"));N&&g(t,M.parse(N))}S.className="color-picker",S.innerHTML='<div class="color-picker-control"><span class="color-picker-h"><i></i></span><span class="color-picker-sv"><i></i></span></div>';var V,X,C=w.body,L=w.documentElement,B=S.firstChild.children,G=v(t,[0,1,1]),R=B[0],T=B[1],$=R.firstChild,j=T.firstChild,A=!1,P=!1,_=0,I=0,D=0,Y=0;return b(1),H.setTimeout(function(){k("create",[n(G),M])},.1),M.target=t,M.picker=S,M.on=m,M.off=y,M.trigger=k,M.fit=x,M.set=function(r){return"string"==typeof r&&(r=M.parse(r)),e(r)?(g(t,r),V(),M):v(t)},M.HSV2RGB=function(t){return r(u(t))},M._HSV2RGB=r,M.HSV2HEX=function(t){return n(u(t))},M._HSV2HEX=n,M.RGB2HSV=function(t){return c(o(t))},M._RGB2HSV=o,M.RGB2HEX=s,M.HEX2HSV=function(t){return c(a(t))},M._HEX2HSV=a,M.HEX2RGB=i,M.hooks=E,M.enter=b,M.exit=X,M};